---
phase: 12-integration-and-polish
plan: 06
type: execute
wave: 2
depends_on: ["12-01"]
files_modified: [src/features/scenarios/index.tsx, src/features/scenarios/scenario-manager.tsx, src/features/export/index.tsx, src/features/export/business-plan-view.tsx, src/components/ai-action-bar.tsx, src/components/ai-suggestion-preview.tsx]
autonomous: true
---

<objective>
Polish scenario engine, export pages, and shared AI components.

Purpose: Scenarios and export are the power-user tools — scenario comparison should feel like a financial modeling tool, and the business plan export should look presentation-ready. AI components appear on every section page and need consistent, professional styling.
Output: Polished scenario editor/comparison, refined export flow, and consistent AI action bar and preview styling.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12-integration-and-polish/12-CONTEXT.md
@.planning/phases/12-integration-and-polish/12-01-PLAN.md

@src/features/scenarios/index.tsx
@src/features/scenarios/scenario-manager.tsx
@src/features/export/index.tsx
@src/features/export/business-plan-view.tsx
@src/components/ai-action-bar.tsx
@src/components/ai-suggestion-preview.tsx
@src/components/page-header.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scenario engine visual polish</name>
  <files>src/features/scenarios/index.tsx, src/features/scenarios/scenario-manager.tsx</files>
  <action>
  Polish the scenario pages to feel like a professional financial modeling tool:

  **Scenario Page (`index.tsx`):**
  - Use `PageHeader`: title "Scenario Modeling", description "Adjust variables and see real-time impact on your business metrics"
  - **Tab styling:** Refine tabs to feel integrated — consider an underline-style tab (`border-b-2 border-primary` for active) instead of the default shadcn pill tabs, for a more dashboard-y feel
  - **Editor tab layout:**
    - Left panel (controls): wrap in a `card-elevated` with title "Variables"
    - Scenario name input: clean inline editable field at the top of the controls panel (not a separate section)
    - Controls: clean slider + number input pairs with label above, value displayed inline
    - Right panel (dashboard): no card wrapper (it contains its own cards) — but add a subtle title "Live Preview" in `text-sm font-semibold text-muted-foreground`
  - **Compare tab:**
    - Comparison table/grid: clean layout with scenario names as column headers
    - Metric rows: alternating subtle backgrounds
    - Values: `tabular-nums` for alignment
    - Differences highlighted with semantic colors (green for better, red for worse)

  **Scenario Manager (`scenario-manager.tsx`):**
  - Cleaner scenario picker: current scenario displayed as a subtle badge
  - Save/Load buttons: refined sizing (sm variant), proper icon + label
  - Delete scenario: ghost icon button with confirmation
  - Scenario list dropdown: clean items with name + date
  - Ensure disabled state (viewer role) looks clearly disabled with muted opacity

  Do NOT change scenario computation, atom reads/writes, or comparison logic.
  </action>
  <verify>Run `npx tsc --noEmit` and `npm run build`. Verify scenario editor renders with polished two-column layout. Verify comparison tab displays correctly.</verify>
  <done>Scenario editor has financial-tool feel with card-elevated panels and clean controls. Comparison view has tabular-nums alignment and semantic difference highlighting. Scenario manager has refined picker and actions. No computation logic changed.</done>
</task>

<task type="auto">
  <name>Task 2: Export pages and shared AI component polish</name>
  <files>src/features/export/index.tsx, src/features/export/business-plan-view.tsx, src/components/ai-action-bar.tsx, src/components/ai-suggestion-preview.tsx</files>
  <action>
  **Export Page (`index.tsx`):**
  - Use `PageHeader`: title "Export", description "Preview and download your business plan"
  - **Tab styling:** Match scenario page tab style (underline tabs for consistency)
  - **Export options card:** `card-elevated` with cleaner layout
    - Active scenario: clean badge display (same pill style as dashboard)
    - Generated date: subtle text
    - Download button: primary, properly sized with icon
    - Error state: clean alert banner (`bg-destructive/10 border-destructive/20`)
  - Footer text: softer, centered

  **Business Plan View (`business-plan-view.tsx`):**
  - This is the presentation-ready view shown to stakeholders. Polish it to look like a document:
  - **Header:** Business name large (`text-3xl font-bold`), "Business Plan" subtitle, date and scenario in muted text
  - **Table of contents:** Clean ordered list with proper spacing, subtle hover on links
  - **Section headers:** Consistent `h2` with section number, subtle bottom border
  - **Content cards:** Maintain existing card-based content rendering but ensure consistent spacing
  - **KPI cards in financial section:** Use `stat-grid` and StatCard patterns
  - **Chart area:** Ensure chart has proper card container
  - **Footer:** Clean separator, business name + date + scenario in single line, muted text
  - **Overall:** Add `max-w-4xl mx-auto` container for readability (like a document width)

  **AI Action Bar (`ai-action-bar.tsx`):**
  - Refine button styling: use a single "AI" button with dropdown (current pattern), but ensure:
    - Button: `size="sm"` with `variant="outline"`, Sparkles icon (size-3.5)
    - Dropdown items: clean with action name + brief description
    - Loading state: consistent spinner
    - Disabled state: proper tooltip explaining why (API key not set)
  - Ensure the bar has consistent width/alignment when placed in PageHeader children

  **AI Suggestion Preview (`ai-suggestion-preview.tsx`):**
  - Refine the preview container:
    - Border: `border-2 border-dashed border-primary/30` (use primary instead of hardcoded purple)
    - Background: `bg-primary/5` (subtle primary tint, not hardcoded purple-50)
    - Header: "AI Suggestion" label with Accept (green) and Reject (ghost) buttons
    - Loading state: centered spinner with "Generating..." text
  - This makes the AI preview work with any theme, not just hardcoded purple

  Do NOT change PDF generation logic, business plan data rendering, or AI API integration.
  </action>
  <verify>Run `npx tsc --noEmit` and `npm run build`. Verify export page tabs render. Verify business plan view has document-like layout. Verify AI components styled consistently.</verify>
  <done>Export page has clean tab interface and polished options card. Business plan view has document-like presentation. AI action bar and preview use theme-aware colors instead of hardcoded purple. All visual polish, no logic changes.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes with zero errors
- [ ] `npm run build` succeeds
- [ ] Scenario editor has card-elevated panels and clean controls
- [ ] Comparison view has tabular-nums and semantic highlighting
- [ ] Export page has consistent tab styling
- [ ] Business plan view has max-width document container
- [ ] AI action bar is compact and theme-aware
- [ ] AI preview uses primary color instead of hardcoded purple
- [ ] No computation, API, or PDF generation logic changed
</verification>

<success_criteria>

- Scenario engine feels like a financial modeling tool
- Export and business plan view are presentation-ready
- AI components are consistent and theme-aware across all sections
- All builds pass
</success_criteria>

<output>
After completion, create `.planning/phases/12-integration-and-polish/12-06-SUMMARY.md`
</output>
