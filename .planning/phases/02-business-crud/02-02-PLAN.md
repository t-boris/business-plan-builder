---
phase: 02-business-crud
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified: [src/features/businesses/create-business.tsx]
autonomous: true
---

<objective>
Build the create business page with a rich template picker UI showing business type cards with icons, descriptions, and section previews, plus a name/description form.

Purpose: This is the primary entry point for new businesses. The template picker is the star feature — users pick a business type from visually rich cards, enter a name and description, and get started immediately.

Output: `src/features/businesses/create-business.tsx`
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-business-crud/02-CONTEXT.md
@.planning/phases/02-business-crud/02-01-SUMMARY.md

@src/lib/business-templates.ts
@src/hooks/use-businesses.ts
@src/store/business-atoms.ts
@src/components/ui/card.tsx
@src/components/ui/input.tsx
@src/components/ui/button.tsx
@src/features/auth/login-page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create the create business page with template picker</name>
  <files>src/features/businesses/create-business.tsx</files>
  <action>
Create `src/features/businesses/create-business.tsx` — a full-page create business flow.

**Layout: Two-step inline flow (NOT a wizard/stepper):**

1. **Step 1: Pick a business type** — Grid of template cards. Each card shows:
   - Lucide icon (dynamically rendered from template's `icon` string)
   - Business type name (e.g., "SaaS / Software")
   - Short description
   - Number of sections included (e.g., "9 sections")
   - Selected state: highlighted border/ring when clicked

2. **Step 2: Enter details** — Appears below or replaces the picker after type is selected:
   - Business name input (required)
   - Brief description textarea (optional)
   - "Create Business" button
   - "Back" link to return to business list

**Component structure:**

```typescript
export function CreateBusiness() {
  const [selectedType, setSelectedType] = useState<BusinessType | null>(null);
  const [name, setName] = useState("");
  const [description, setDescription] = useState("");
  const [isCreating, setIsCreating] = useState(false);
  const { createNewBusiness } = useBusinesses();
  const navigate = useNavigate();

  async function handleCreate(e: React.FormEvent) {
    e.preventDefault();
    if (!selectedType || !name.trim()) return;
    setIsCreating(true);
    try {
      await createNewBusiness(name.trim(), selectedType, description.trim());
      navigate("/"); // Go to business list (or dashboard when business context exists)
    } catch {
      // Handle error — show toast or error state
    } finally {
      setIsCreating(false);
    }
  }

  // Render template cards grid + form
}
```

**Template card rendering:**

Import Lucide icons dynamically. Since the icon field is a string name (e.g., "Cloud"), use a mapping object from icon name to component:

```typescript
import {
  Cloud, Users, ShoppingBag, UtensilsCrossed,
  PartyPopper, Factory, Sparkles,
} from "lucide-react";
import type { LucideIcon } from "lucide-react";

const iconMap: Record<string, LucideIcon> = {
  Cloud, Users, ShoppingBag, UtensilsCrossed,
  PartyPopper, Factory, Sparkles,
};
```

Then render each template card:
```tsx
<button
  onClick={() => setSelectedType(template.type)}
  className={cn(
    "text-left rounded-lg border p-4 transition-all hover:border-primary/50",
    selectedType === template.type
      ? "border-primary ring-2 ring-primary/20 bg-primary/5"
      : "border-border"
  )}
>
  <Icon className="size-8 mb-3 text-primary" />
  <h3 className="font-semibold">{template.name}</h3>
  <p className="text-sm text-muted-foreground mt-1">{template.description}</p>
  <p className="text-xs text-muted-foreground mt-2">
    {template.defaultSections.length} sections
  </p>
</button>
```

**Grid layout:** `grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4`

**Form section:** Only visible when a type is selected. Shows name input, description textarea, create button.

**Navigation:** Use `useNavigate` from `react-router` for navigation after creation and for the back link.

**Styling:** Use existing shadcn components (Card, Input, Button, Textarea) and Tailwind classes. Follow existing component patterns from login-page.tsx.

**IMPORTANT:**
- Named export: `export function CreateBusiness()`
- Use `cn()` from `@/lib/utils` for conditional classes
- Import BUSINESS_TYPE_TEMPLATES from `@/lib/business-templates`
- Import useBusinesses from `@/hooks/use-businesses`
- Do NOT create any other files — this is a single-file component
  </action>
  <verify>npx tsc --noEmit passes with no errors</verify>
  <done>Create business page renders template picker grid with 7 business types, shows name/description form when type selected, calls createNewBusiness on submit, navigates on success. Compiles cleanly.</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes with zero errors
- [ ] `src/features/businesses/create-business.tsx` exports CreateBusiness component
- [ ] Template cards render all 7 business types with icons
- [ ] Form appears after type selection
- [ ] Create button calls useBusinesses().createNewBusiness
- [ ] Navigation after creation works
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No errors or warnings introduced
- Template picker shows rich cards with icon, name, description, section count
- Selected type has visual highlight
- Form collects name (required) and description (optional)
- Create action integrates with useBusinesses hook
</success_criteria>

<output>
After completion, create `.planning/phases/02-business-crud/02-02-SUMMARY.md`
</output>
